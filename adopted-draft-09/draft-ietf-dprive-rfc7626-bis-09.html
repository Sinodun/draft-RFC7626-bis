<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS Privacy Considerations</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Scope">
<link href="#rfc.section.3" rel="Chapter" title="3 Risks">
<link href="#rfc.section.4" rel="Chapter" title="4 Risks in the DNS Data">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 The Public Nature of DNS Data">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Data in the DNS Request">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Data in the DNS Payload">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Cache Snooping">
<link href="#rfc.section.5" rel="Chapter" title="5 Risks On the Wire">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Unencrypted Transports">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Encrypted Transports">
<link href="#rfc.section.6" rel="Chapter" title="6 Risks in the Servers">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 In the Recursive Resolvers">
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 Resolver Selection">
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Active Attacks on Resolver Configuration">
<link href="#rfc.section.6.1.3" rel="Chapter" title="6.1.3 Blocking of User Selected DNS Resolution Services">
<link href="#rfc.section.6.1.4" rel="Chapter" title="6.1.4 Encrypted Transports and Recursive Resolvers">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 In the Authoritative Name Servers">
<link href="#rfc.section.7" rel="Chapter" title="7 Other risks">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Re-identification and Other Inferences">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 More Information">
<link href="#rfc.section.8" rel="Chapter" title='8 Actual "Attacks"'>
<link href="#rfc.section.9" rel="Chapter" title="9 Legalities">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.12" rel="Chapter" title="12 Contributions">
<link href="#rfc.section.13" rel="Chapter" title="13 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="14 References">
<link href="#rfc.references.1" rel="Chapter" title="14.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="14.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Updates since RFC7626">
<link href="#rfc.appendix.B" rel="Chapter" title="B Changelog">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 3.5.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Wicinski, T., Ed." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-dprive-rfc7626-bis-09" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-10-26" />
  <meta name="dct.abstract" content="This document describes the privacy issues associated with the use of the DNS by Internet users. It provides general observations about typical current privacy practices. It is intended to be an analysis of the present situation and does not prescribe solutions. This document obsoletes RFC 7626.   " />
  <meta name="description" content="This document describes the privacy issues associated with the use of the DNS by Internet users. It provides general observations about typical current privacy practices. It is intended to be an analysis of the present situation and does not prescribe solutions. This document obsoletes RFC 7626.   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">dprive</td>
<td class="right">T. Wicinski, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">October 26, 2020</td>
</tr>
<tr>
<td class="left">Obsoletes: 7626 (if approved)</td>
<td class="right"></td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right"></td>
</tr>
<tr>
<td class="left">Expires: April 29, 2021</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS Privacy Considerations<br />
  <span class="filename">draft-ietf-dprive-rfc7626-bis-09</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes the privacy issues associated with the use of the DNS by Internet users. It provides general observations about typical current privacy practices. It is intended to be an analysis of the present situation and does not prescribe solutions. This document obsoletes RFC 7626.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 29, 2021.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Scope</a>
</li>
<li>3.   <a href="#rfc.section.3">Risks</a>
</li>
<li>4.   <a href="#rfc.section.4">Risks in the DNS Data</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">The Public Nature of DNS Data</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Data in the DNS Request</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Data in the DNS Payload</a>
</li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Cache Snooping</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Risks On the Wire</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Unencrypted Transports</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Encrypted Transports</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">Risks in the Servers</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">In the Recursive Resolvers</a>
</li>
<ul><li>6.1.1.   <a href="#rfc.section.6.1.1">Resolver Selection</a>
</li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Active Attacks on Resolver Configuration</a>
</li>
<li>6.1.3.   <a href="#rfc.section.6.1.3">Blocking of User Selected DNS Resolution Services</a>
</li>
<li>6.1.4.   <a href="#rfc.section.6.1.4">Encrypted Transports and Recursive Resolvers</a>
</li>
</ul><li>6.2.   <a href="#rfc.section.6.2">In the Authoritative Name Servers</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Other risks</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Re-identification and Other Inferences</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">More Information</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Actual "Attacks"</a>
</li>
<li>9.   <a href="#rfc.section.9">Legalities</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>12.   <a href="#rfc.section.12">Contributions</a>
</li>
<li>13.   <a href="#rfc.section.13">Acknowledgments</a>
</li>
<li>14.   <a href="#rfc.references">References</a>
</li>
<ul><li>14.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>14.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Updates since RFC7626</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Changelog</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document is an analysis of the DNS privacy issues, in the spirit of Section 8 of <a href="#RFC6973" class="xref">[RFC6973]</a>.  </p>
<p id="rfc.section.1.p.2">The Domain Name System (DNS) is specified in <a href="#RFC1034" class="xref">[RFC1034]</a>, <a href="#RFC1035" class="xref">[RFC1035]</a>, and many later RFCs, which have never been consolidated. It is one of the most important infrastructure components of the Internet and often ignored or misunderstood by Internet users (and even by many professionals). Almost every activity on the Internet starts with a DNS query (and often several).  Its use has many privacy implications and this document is an attempt at a comprehensive and accurate list.  </p>
<p id="rfc.section.1.p.3">Let us begin with a simplified reminder of how the DNS works (See also <a href="#RFC8499" class="xref">[RFC8499]</a>). A client, the stub resolver, issues a DNS query to a server, called the recursive resolver (also called caching resolver or full resolver or recursive name server). Let's use the query "What are the AAAA records for www.example.com?" as an example. AAAA is the QTYPE (Query Type), and www.example.com is the QNAME (Query Name). (The description that follows assumes a cold cache, for instance, because the server just started.) The recursive resolver will first query the root name servers. In most cases, the root name servers will send a referral. In this example, the referral will be to the .com name servers. The resolver repeats the query to one of the .com name servers. The .com name servers, in turn, will refer to the example.com name servers. The example.com name server will then return the answer. The root name servers, the name servers of .com, and the name servers of example.com are called authoritative name servers. It is important, when analyzing the privacy issues, to remember that the question asked to all these name servers is always the original question, not a derived question. The question sent to the root name servers is "What are the AAAA records for www.example.com?", not "What are the name servers of .com?". By repeating the full question, instead of just the relevant part of the question to the next in line, the DNS provides more information than necessary to the name server. In this simplified description, recursive resolvers do not implement QNAME minimization as described in <a href="#RFC7816" class="xref">[RFC7816]</a>, which will only send the relevant part of the question to the upstream name server.  </p>
<p id="rfc.section.1.p.4">DNS relies heavily on caching, so the algorithm described above is actually a bit more complicated, and not all questions are sent to the authoritative name servers.  If a few seconds later the stub resolver asks the recursive resolver, "What are the SRV records of _xmpp-server._tcp.example.com?", the recursive resolver will remember that it knows the name servers of example.com and will just query them, bypassing the root and .com.  Because there is typically no caching in the stub resolver, the recursive resolver, unlike the authoritative servers, sees all the DNS traffic.  (Applications, like web browsers, may have some form of caching that does not follow DNS rules, for instance, because it may ignore the TTL.  So, the recursive resolver does not see all the name resolution activity.) </p>
<p id="rfc.section.1.p.5">It should be noted that DNS recursive resolvers sometimes forward requests to other recursive resolvers, typically bigger machines, with a larger and more shared cache (and the query hierarchy can be even deeper, with more than two levels of recursive resolvers).  From the point of view of privacy, these forwarders are like resolvers, except that they do not see all of the requests being made (due to caching in the first resolver).  </p>
<p id="rfc.section.1.p.6">At the time of writing, almost all this DNS traffic is currently sent unencrypted. However, there is increasing deployment of DNS-over-TLS (DoT) <a href="#RFC7858" class="xref">[RFC7858]</a> and DNS-over-HTTPS (DoH) <a href="#RFC8484" class="xref">[RFC8484]</a>, particularly in mobile devices, browsers, and by providers of anycast recursive DNS resolution services. There are a few cases where there is some alternative channel encryption, for instance, in an IPsec VPN tunnel, at least between the stub resolver and the resolver.   Some recent analysis on service quality of encrypted DNS traffic can be found in <a href="#dns-over-encryption" class="xref">[dns-over-encryption]</a>.  </p>
<p id="rfc.section.1.p.7">Today, almost all DNS queries are sent over UDP <a href="#thomas-ditl-tcp" class="xref">[thomas-ditl-tcp]</a>. This has practical consequences when considering encryption of the traffic as a possible privacy technique. Some encryption solutions are only designed for TCP, not UDP, although new solutions are still emerging <a href="#I-D.ietf-quic-transport" class="xref">[I-D.ietf-quic-transport]</a> <a href="#I-D.ietf-dprive-dnsoquic" class="xref">[I-D.ietf-dprive-dnsoquic]</a>.  </p>
<p id="rfc.section.1.p.8">Another important point to keep in mind when analyzing the privacy issues of DNS is the fact that DNS requests received by a server are triggered by different reasons.  Let's assume an eavesdropper wants to know which web page is viewed by a user.  For a typical web page, there are three sorts of DNS requests being issued: </p>
<p></p>

<ul>
<li>Primary request: this is the domain name in the URL that the user typed, selected from a bookmark, or chose by clicking on an hyperlink.  Presumably, this is what is of interest for the eavesdropper.</li>
<li>Secondary requests: these are the additional requests performed by the user agent (here, the web browser) without any direct involvement or knowledge of the user.  For the Web, they are triggered by embedded content, Cascading Style Sheets (CSS), JavaScript code, embedded images, etc.  In some cases, there can be dozens of domain names in different contexts on a single web page.</li>
<li>Tertiary requests: these are the additional requests performed by the DNS system itself.  For instance, if the answer to a query is a referral to a set of name servers, and the glue records are not returned, the resolver will have to do additional requests to turn the name servers' names into IP addresses.  Similarly, even if glue records are returned, a careful recursive server will do tertiary requests to verify the IP addresses of those records.</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.10">It can also be noted that, in the case of a typical web browser, more DNS requests than strictly necessary are sent, for instance, to prefetch resources that the user may query later or when autocompleting the URL in the address bar.  Both are a significant privacy concern since they may leak information even about non-explicit actions.  For instance, just reading a local HTML page, even without selecting the hyperlinks, may trigger DNS requests.  </p>
<p id="rfc.section.1.p.11">For privacy-related terms, the terminology is from <a href="#RFC6973" class="xref">[RFC6973]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#scope" id="scope">Scope</a>
</h1>
<p id="rfc.section.2.p.1">This document focuses mostly on the study of privacy risks for the end user (the one performing DNS requests).  The risks of pervasive surveillance <a href="#RFC7258" class="xref">[RFC7258]</a> are considered as well as risks coming from a more focused surveillance.  </p>
<p id="rfc.section.2.p.2">This document does not attempt a comparison of specific privacy protections provided by individual networks or organizations, it makes only general observations about typical current practices.  </p>
<p id="rfc.section.2.p.3">Privacy risks for the holder of a zone (the risk that someone gets the data) are discussed in <a href="#RFC5936" class="xref">[RFC5936]</a> and <a href="#RFC5155" class="xref">[RFC5155]</a>.  </p>
<p id="rfc.section.2.p.4">Privacy risks for recursive operators (including access providers and operators in enterprise networks) such as leakage of private namespaces or blocklists are out of scope for this document.  </p>
<p id="rfc.section.2.p.5">Non-privacy risks (e.g security related considerations such as cache poisoning) are also out of scope.  </p>
<p id="rfc.section.2.p.6">The privacy risks associated with the use of other protocols that make use of DNS information are not considered here.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#risks" id="risks">Risks</a>
</h1>
<p id="rfc.section.3.p.1">The following four sections outline the privacy considerations associated with different aspects of the DNS for the end user. When reading these sections it needs to be kept in mind that many of the considerations (for example, recursive resolver and transport protocol) can be specific to the network context that a device is using at a given point in time. A user may have many devices and each device might utilize many different networks (e.g. home, work, public or cellular) over a period of time or even concurrently. An exhaustive analysis of the privacy considerations for an individual user would need to take into account the set of devices used and the multiple dynamic contexts of each device. This document does not attempt such a complex analysis, but instead it presents an overview of the various considerations that could form the basis of such an analysis.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#risks-in-the-dns-data" id="risks-in-the-dns-data">Risks in the DNS Data</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#the-public-nature-of-dns-data" id="the-public-nature-of-dns-data">The Public Nature of DNS Data</a>
</h1>
<p id="rfc.section.4.1.p.1">It has been stated that "the data in the DNS is public".  This sentence makes sense for an Internet-wide lookup system,  and there are multiple facets to the data and metadata involved that deserve a more detailed look.  First, access control lists (ACLs) and private namespaces notwithstanding, the DNS operates under the assumption that public-facing authoritative name servers will respond to "usual" DNS queries for any zone they are authoritative for without further authentication or authorization of the client (resolver).  Due to the lack of search capabilities, only a given QNAME will reveal the resource records associated with that name (or that name's non- existence).  In other words: one needs to know what to ask for, in order to receive a response. There are many ways in which supposedly "private" resources currently leak. A few  examples are  DNSSEC NSEC zone walking<a href="#RFC4470" class="xref">[RFC4470]</a>; passive-DNS services[passive-dns]; etc. The zone transfer QTYPE <a href="#RFC5936" class="xref">[RFC5936]</a> is often blocked or restricted to authenticated/authorized access to enforce this difference (and maybe for other reasons).  </p>
<p id="rfc.section.4.1.p.2">Another difference between the DNS data and a particular DNS transaction (i.e., a DNS name lookup).  DNS data and the results of a DNS query are public, within the boundaries described above, and may not have any confidentiality requirements.  However, the same is not true of a single transaction or a sequence of transactions; those transactions are not / should not be public. A single transaction reveals both the originator of the query and the query contents which potentially leaks sensitive information about a specific user. A typical example from outside the DNS world is: the web site of Alcoholics Anonymous is public; the fact that you visit it should not be. Furthermore, the ability to link queries reveals information about individual use patterns.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#data-in-the-dns-request" id="data-in-the-dns-request">Data in the DNS Request</a>
</h1>
<p id="rfc.section.4.2.p.1">The DNS request includes many fields, but two of them seem particularly relevant for the privacy issues: the QNAME and the source IP address.  "source IP address" is used in a loose sense of "source IP address + maybe source port number", because the port number is also in the request and can be used to differentiate between several users sharing an IP address (behind a Carrier-Grade NAT (CGN), for instance <a href="#RFC6269" class="xref">[RFC6269]</a>).  </p>
<p id="rfc.section.4.2.p.2">The QNAME is the full name sent by the user.  It gives information about what the user does ("What are the MX records of example.net?" means he probably wants to send email to someone at example.net, which may be a domain used by only a few persons and is therefore very revealing about communication relationships).  Some QNAMEs are more sensitive than others.  For instance, querying the A record of a well-known web statistics domain reveals very little (everybody visits web sites that use this analytics service), but querying the A record of www.verybad.example where verybad.example is the domain of an organization that some people find offensive or objectionable may create more problems for the user.  Also, sometimes, the QNAME embeds the software one uses, which could be a privacy issue.  For instance, _ldap._tcp.Default-First-Site-Name._sites.gc._msdcs.example.org.  There are also some BitTorrent clients that query an SRV record for _bittorrent-tracker._tcp.domain.example.  </p>
<p id="rfc.section.4.2.p.3">Another important thing about the privacy of the QNAME is the future usages.  Today, the lack of privacy is an obstacle to putting potentially sensitive or personally identifiable data in the DNS.  At the moment, your DNS traffic might reveal that you are doing email but not with whom.  If your Mail User Agent (MUA) starts looking up Pretty Good Privacy (PGP) keys in the DNS <a href="#RFC7929" class="xref">[RFC7929]</a>, then privacy becomes a lot more important.  And email is just an example; there would be other really interesting uses for a more privacy-friendly DNS.  </p>
<p id="rfc.section.4.2.p.4">For the communication between the stub resolver and the recursive resolver, the source IP address is the address of the user's machine. Therefore, all the issues and warnings about collection of IP addresses apply here. For the communication between the recursive resolver and the authoritative name servers, the source IP address has a different meaning; it does not have the same status as the source address in an HTTP connection. It can be typically the IP address of the recursive resolver that, in a way, "hides" the real user.  However, hiding does not always work. Sometimes EDNS(0) Client subnet <a href="#RFC7871" class="xref">[RFC7871]</a> is used (see one privacy analysis in <a href="#denis-edns-client-subnet" class="xref">[denis-edns-client-subnet]</a>).  Sometimes the end user has a personal recursive resolver on her machine. In both cases, the IP address originating queries to the authoritative server is as sensitive as it is for HTTP <a href="#sidn-entrada" class="xref">[sidn-entrada]</a>.  </p>
<p id="rfc.section.4.2.p.5">A note about IP addresses: there is currently no IETF document that describes in detail all the privacy issues around IP addressing in general, although <a href="#RFC7721" class="xref">[RFC7721]</a> does discuss privacy considerations for IPv6 address generation mechanisms. In the meantime, the discussion here is intended to include both IPv4 and IPv6 source addresses. For a number of reasons, their assignment and utilization characteristics are different, which may have implications for details of information leakage associated with the collection of source addresses. (For example, a specific IPv6 source address seen on the public Internet is less likely than an IPv4 address to originate behind an address sharing scheme.) However, for both IPv4 and IPv6 addresses, it is important to note that source addresses are propagated with queries via EDNS(0) Client subnet and comprise metadata about the host, user, or application that originated them.  </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#data-in-the-dns-payload" id="data-in-the-dns-payload">Data in the DNS Payload</a>
</h1>
<p id="rfc.section.4.2.1.p.1">At the time of writing there are no standardized client identifiers contained in the DNS payload itself (ECS <a href="#RFC7871" class="xref">[RFC7871]</a> while widely used is only of Category Informational).  </p>
<p id="rfc.section.4.2.1.p.2">DNS Cookies <a href="#RFC7873" class="xref">[RFC7873]</a> are a lightweight DNS transaction security mechanism that provides limited protection against a variety of increasingly common denial-of-service and amplification/forgery or cache poisoning attacks by off-path attackers. It is noted, however, that they are designed to just verify IP addresses (and should change once a client's IP address changes), but they are not designed to actively track users (like HTTP cookies).  </p>
<p id="rfc.section.4.2.1.p.3">There are anecdotal accounts of <a href="https://lists.dns-oarc.net/pipermail/dns-operations/2016-January/014143.html">MAC addresses</a> and even user names being inserted in non-standard EDNS(0) options <a href="#RFC6891" class="xref">[RFC6891]</a> for stub to resolver communications to support proprietary functionality implemented at the resolver (e.g., parental filtering).  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#cache-snooping" id="cache-snooping">Cache Snooping</a>
</h1>
<p id="rfc.section.4.3.p.1">The content of recursive resolvers' caches can reveal data about the clients using it (the privacy risks depend on the number of clients).  This information can sometimes be examined by sending DNS queries with RD=0 to inspect cache content, particularly looking at the DNS TTLs <a href="#grangeia.snooping" class="xref">[grangeia.snooping]</a>.  Since this also is a reconnaissance technique for subsequent cache poisoning attacks, some counter measures have already been developed and deployed <a href="#cache-snooping-defence" class="xref">[cache-snooping-defence]</a>.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#risks-on-the-wire" id="risks-on-the-wire">Risks On the Wire</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#unencrypted-transports" id="unencrypted-transports">Unencrypted Transports</a>
</h1>
<p id="rfc.section.5.1.p.1">For unencrypted transports, DNS traffic can be seen by an eavesdropper like any other traffic. (DNSSEC, specified in <a href="#RFC4033" class="xref">[RFC4033]</a>, explicitly excludes confidentiality from its goals.) So, if an initiator starts an HTTPS communication with a recipient, while the HTTP traffic will be encrypted, the DNS exchange prior to it will not be. When other protocols will become more and more privacy-aware and secured against surveillance (e.g., <a href="#RFC8446" class="xref">[RFC8446]</a>, <a href="#I-D.ietf-quic-transport" class="xref">[I-D.ietf-quic-transport]</a>), the use of unencrypted transports for DNS may become "the weakest link" in privacy. It is noted that at the time of writing there is on-going work attempting to encrypt the SNI in the TLS handshake <a href="#RFC8744" class="xref">[RFC8744]</a>, which is one of the last remaining non-DNS cleartext identifiers of a connection target.  </p>
<p id="rfc.section.5.1.p.2">An important specificity of the DNS traffic is that it may take a different path than the communication between the initiator and the recipient.  For instance, an eavesdropper may be unable to tap the wire between the initiator and the recipient but may have access to the wire going to the recursive resolver, or to the authoritative name servers.  </p>
<p id="rfc.section.5.1.p.3">The best place to tap, from an eavesdropper's point of view, is clearly between the stub resolvers and the recursive resolvers, because traffic is not limited by DNS caching.  </p>
<p id="rfc.section.5.1.p.4">The attack surface between the stub resolver and the rest of the world can vary widely depending upon how the end user's device is configured.  By order of increasing attack surface: </p>
<p></p>

<ul>
<li>The recursive resolver can be on the end user's device.  In (currently) a small number of cases, individuals may choose to operate their own DNS resolver on their local machine.  In this case, the attack surface for the connection between the stub resolver and the caching resolver is limited to that single machine. The recursive resolver will expose data to authoritative resolvers as discussed in <a href="#in-the-authoritative-name-servers" class="xref">Section 6.2</a>.</li>
<li>The recursive resolver may be at the local network edge.  For many/most enterprise networks and for some residential networks, the caching resolver may exist on a server at the edge of the local network.  In this case, the attack surface is the local network.  Note that in large enterprise networks, the DNS resolver may not be located at the edge of the local network but rather at the edge of the overall enterprise network.  In this case, the enterprise network could be thought of as similar to the Internet Access Provider (IAP) network referenced below.</li>
<li>The recursive resolver can be in the IAP network. For most residential networks and potentially other networks, the typical case is for the user's device to be configured (typically automatically through DHCP or RA options) with the addresses of the DNS proxy in the Customer Premise Equipment (CPE), which in turns points to the DNS recursive resolvers at the IAP. The attack surface for on-the-wire attacks is therefore from the end user system across the local network and across the IAP network to the IAP's recursive resolvers.</li>
<li>The recursive resolver can be a public DNS service (or a privately run DNS resolver hosted on the public internet).  Some machines may be configured to use public DNS resolvers such as those operated by Google Public DNS or OpenDNS.  The user may have configured their machine to use these DNS recursive resolvers themselves -- or their IAP may have chosen to use the public DNS resolvers rather than operating their own resolvers.  In this case, the attack surface is the entire public Internet between the user's connection and the public DNS service. It can be noted that if the user selects a single resolver with a small client population (even when using an encrypted transport) it can actually serve to aid tracking of that user as they move across network environments.</li>
</ul>

<p> </p>
<p id="rfc.section.5.1.p.6">It is also noted that typically a device connected <em>only</em> to a modern cellular network is </p>
<p></p>

<ul>
<li>directly configured with only the recursive resolvers of the IAP and</li>
<li>afforded some level of protection against some types of eavesdropping for all traffic (including DNS traffic) due to the cellular network link-layer encryption.  <br>
</li>
</ul>

<p> </p>
<p id="rfc.section.5.1.p.8">The attack surface for this specific scenario is not considered here.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#encrypted-transports" id="encrypted-transports">Encrypted Transports</a>
</h1>
<p id="rfc.section.5.2.p.1">The use of encrypted transports directly mitigates passive surveillance of the DNS payload, however there are still some privacy attacks possible. This section enumerates the residual privacy risks to an end user when an attacker can passively monitor encrypted DNS traffic flows on the wire.  </p>
<p id="rfc.section.5.2.p.2">These are cases where user identification, fingerprinting or correlations may be possible due to the use of certain transport layers or clear text/observable features. These issues are not specific to DNS, but DNS traffic is susceptible to these attacks when using specific transports.  </p>
<p id="rfc.section.5.2.p.3">There are some general examples, for example, certain studies have highlighted that IPv4 TTL, IPv6 Hop Limit, or TCP Window sizes <a href="http://netres.ec/?b=11B99BD">os-fingerprint</a> values can be used to fingerprint client OS's or that various techniques can be used to de-NAT DNS queries [dns-de-nat].  </p>
<p id="rfc.section.5.2.p.4">Note that even when using encrypted transports, the use of clear text transport options to decrease latency can provide correlation of a users' connections, e.g. using TCP Fast Open <a href="#RFC7413" class="xref">[RFC7413]</a>.  </p>
<p id="rfc.section.5.2.p.5">Implementations that support encrypted transports also commonly re-use connections for multiple DNS queries to optimize performance (e.g. via DNS pipelining or HTTPS multiplexing). Default configuration options for encrypted transports could in principle fingerprint a specific client application. For example: </p>
<p></p>

<ul>
<li>TLS version or cipher suite selection</li>
<li>session resumption</li>
<li>the maximum number of messages to send or</li>
<li>a maximum connection time before closing a connections and re-opening.</li>
</ul>

<p> </p>
<p id="rfc.section.5.2.p.7">If libraries or applications offer user configuration of such options (e.g.  <a href="#getdns" class="xref">[getdns]</a>) then they could in principle help to identify a specific user. Users may want to use only the defaults to avoid this issue.  </p>
<p id="rfc.section.5.2.p.8">Whilst there are known attacks on older versions of TLS, the most recent recommendations <a href="#RFC7525" class="xref">[RFC7525]</a> and the development of TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> largely mitigate those.  </p>
<p id="rfc.section.5.2.p.9">Traffic analysis of unpadded encrypted traffic is also possible <a href="#pitfalls-of-dns-encryption" class="xref">[pitfalls-of-dns-encryption]</a> because the sizes and timing of encrypted DNS requests and responses can be correlated to unencrypted DNS requests upstream of a recursive resolver.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#risks-in-the-servers" id="risks-in-the-servers">Risks in the Servers</a>
</h1>
<p id="rfc.section.6.p.1">Using the terminology of <a href="#RFC6973" class="xref">[RFC6973]</a>, the DNS servers (recursive resolvers and authoritative servers) are enablers: they facilitate communication between an initiator and a recipient without being directly in the communications path.  As a result, they are often forgotten in risk analysis.  But, to quote again <a href="#RFC6973" class="xref">[RFC6973]</a>, "Although [...] enablers may not generally be considered as attackers, they may all pose privacy threats (depending on the context) because they are able to observe, collect, process, and transfer privacy-relevant data."  In <a href="#RFC6973" class="xref">[RFC6973]</a> parlance, enablers become observers when they start collecting data.  </p>
<p id="rfc.section.6.p.2">Many programs exist to collect and analyze DNS data at the servers -- from the "query log" of some programs like BIND to tcpdump and more sophisticated programs like PacketQ <a href="#packetq" class="xref">[packetq]</a> and DNSmezzo <a href="#dnsmezzo" class="xref">[dnsmezzo]</a>. The organization managing the DNS server can use this data itself, or it can be part of a surveillance program like PRISM <a href="#prism" class="xref">[prism]</a> and pass data to an outside observer.  </p>
<p id="rfc.section.6.p.3">Sometimes, this data is kept for a long time and/or distributed to third parties for research purposes <a href="#ditl" class="xref">[ditl]</a> <a href="#day-at-root" class="xref">[day-at-root]</a>, security analysis, or surveillance tasks.  These uses are sometimes under some sort of contract, with various limitations, for instance, on redistribution, given the sensitive nature of the data.  Also, there are observation points in the network that gather DNS data and then make it accessible to third parties for research or security purposes ("passive DNS" <a href="#passive-dns" class="xref">[passive-dns]</a>).  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#in-the-recursive-resolvers" id="in-the-recursive-resolvers">In the Recursive Resolvers</a>
</h1>
<p id="rfc.section.6.1.p.1">Recursive Resolvers see all the traffic since there is typically no caching before them.  To summarize: your recursive resolver knows a lot about you.  The resolver of a large IAP, or a large public resolver, can collect data from many users.  </p>
<h1 id="rfc.section.6.1.1">
<a href="#rfc.section.6.1.1">6.1.1.</a> <a href="#resolver-selection" id="resolver-selection">Resolver Selection</a>
</h1>
<p id="rfc.section.6.1.1.p.1">Given all the above considerations, the choice of recursive resolver has direct privacy considerations for end users. Historically, end user devices have used the DHCP-provided local network recursive resolver. The choice by a user to join a particular network (e.g. by physically plugging in a cable or selecting a network in a OS dialogue) typically updates a number of system resources - these can include IP addresses, availability of IPv4/IPv6, DHCP server, and DNS resolver. These individual changes, including the change in DNS resolver, are not normally communicated directly to the user by the OS when the network is joined. The choice of network has historically determined the default system DNS resolver selection; the two are directly coupled in this model.  </p>
<p id="rfc.section.6.1.1.p.2">The vast majority of users do not change their default system DNS settings and so implicitly accept the network settings for DNS. The network resolvers have therefore historically been the sole destination for all of the DNS queries from a device. These resolvers may have varied privacy policies depending on the network. Privacy policies for these servers may or may not be available and users need to be aware that privacy guarantees will vary with the network.  </p>
<p id="rfc.section.6.1.1.p.3">All major OS&#8217;s expose the system DNS settings and allow users to manually override them if desired.  </p>
<p id="rfc.section.6.1.1.p.4">More recently, some networks and users have actively chosen to use a large public resolver, e.g., <a href="https://developers.google.com/speed/public-dns">Google Public DNS</a>, <a href="https://developers.cloudflare.com/1.1.1.1/setting-up-1.1.1.1/">Cloudflare</a>, or <a href="https://www.quad9.net">Quad9</a>. There can be many reasons: cost considerations for network operators, better reliability or anti-censorship considerations are just a few. Such services typically do provide a privacy policy and the user can get an idea of the data collected by such operators by reading one e.g., <a href="https://developers.google.com/speed/public-dns/privacy">Google Public DNS - Your Privacy</a>.  </p>
<p id="rfc.section.6.1.1.p.5">In general, as with many other protocols, issues around centralization also arise with DNS. The picture is fluid with several competing factors contributing which can also vary by geographic region. These include: </p>
<p></p>

<ul>
<li>ISP outsourcing, including to third party and public resolvers</li>
<li>regional market domination by one or only a few ISPs</li>
<li>applications directing DNS traffic by default to a limited subset of resolvers, see <a href="#applicationspecific-resolver-selection" class="xref">Section 6.1.1.2</a>
</li>
</ul>

<p> </p>
<p id="rfc.section.6.1.1.p.7">An increased proportion of the global DNS resolution traffic being served by only a few entities means that the privacy considerations for users are highly dependent on the privacy policies and practices of those entities. Many of the issues around centralization are discussed in <a href="#centralisation-and-data-sovereignty" class="xref">[centralisation-and-data-sovereignty]</a>.  </p>
<h1 id="rfc.section.6.1.1.1">
<a href="#rfc.section.6.1.1.1">6.1.1.1.</a> <a href="#dynamic-discovery-of-doh-and-strict-dot" id="dynamic-discovery-of-doh-and-strict-dot">Dynamic Discovery of DoH and Strict DoT</a>
</h1>
<p id="rfc.section.6.1.1.1.p.1">Whilst support for opportunistic DoT can be determined by probing a resolver on port 853, there is currently no standardized discovery mechanism for DoH and Strict DoT servers.  </p>
<p id="rfc.section.6.1.1.1.p.2">This means that clients which might want to dynamically discover such encrypted services, and where users are willing to trust such services, are not able to do so. At the time of writing, efforts to provide standardized signaling mechanisms to discover the services offered by local resolvers are in progress <a href="#I-D.ietf-dnsop-resolver-information" class="xref">[I-D.ietf-dnsop-resolver-information]</a>. Note that an increasing numbers of ISPs are deploying encrypted DNS, for example see the Encrypted DNS Deployment Initiative <a href="#EDDI" class="xref">[EDDI]</a>.  </p>
<h1 id="rfc.section.6.1.1.2">
<a href="#rfc.section.6.1.1.2">6.1.1.2.</a> <a href="#applicationspecific-resolver-selection" id="applicationspecific-resolver-selection">Application-specific Resolver Selection</a>
</h1>
<p id="rfc.section.6.1.1.2.p.1">An increasing number of applications are offering application- specific encrypted DNS resolution settings, rather than defaulting to using only the system resolver.  A variety of heuristics and resolvers are available in different applications including hard- coded lists of recognized DoH/DoT servers.  </p>
<p id="rfc.section.6.1.1.2.p.2">Generally, users are not aware of application specific DNS settings, and may not have control over those settings. To address these limitations, users will only be aware of and have the ability to control such settings if applications provide the following functions: </p>
<p id="rfc.section.6.1.1.2.p.3">o  communicate clearly to users the change when the default application resolver changes away from the system resolver </p>
<p id="rfc.section.6.1.1.2.p.4">o  provide configuration options to change the default application resolver </p>
<p id="rfc.section.6.1.1.2.p.5">o  provide configuration options to always use the system resolver </p>
<p id="rfc.section.6.1.1.2.p.6">Application-specific changes to default destinations for users' DNS queries might increase or decrease user privacy - it is highly dependent on the network context and the application-specific default.  This is an area of active debate and the IETF is working on a number of issues related to application-specific DNS settings.  </p>
<h1 id="rfc.section.6.1.2">
<a href="#rfc.section.6.1.2">6.1.2.</a> <a href="#active-attacks-on-resolver-configuration" id="active-attacks-on-resolver-configuration">Active Attacks on Resolver Configuration</a>
</h1>
<p id="rfc.section.6.1.2.p.1">The previous section discussed DNS privacy, assuming that all the traffic was directed to the intended servers (i.e those that would be used in the absence of an active attack) and that the potential attacker was purely passive. But, in reality, there can be active attackers in the network.  </p>
<p id="rfc.section.6.1.2.p.2">The Internet Threat model, as described in <a href="#RFC3552" class="xref">[RFC3552]</a>, assumes that the attacker controls the network. Such an attacker can completely control any insecure DNS resolution, both passively monitoring the queries and responses and substituting their own responses. Even if encrypted DNS such as DoH or DoT is used, unless the client has been configured in a secure way with the server identity, an active attacker can impersonate the server. This implies that opportunistic modes of DoH/DoT as well as modes where the client learns of the DoH/DoT server via in-network mechanisms such as DHCP are vulnerable to attack. In addition, if the client is compromised, the attacker can replace the DNS configuration with one of its own choosing.  </p>
<h1 id="rfc.section.6.1.3">
<a href="#rfc.section.6.1.3">6.1.3.</a> <a href="#blocking-of-user-selected-dns-resolution-services" id="blocking-of-user-selected-dns-resolution-services">Blocking of User Selected DNS Resolution Services</a>
</h1>
<p id="rfc.section.6.1.3.p.1">User privacy can also be at risk if there is blocking of access to remote recursive servers that offer encrypted transports e.g., when the local resolver does not offer encryption and/or has very poor privacy policies. For example, active blocking of port 853 for DoT or of specific IP addresses could restrict the resolvers available to the user. The extent of the risk to user privacy is highly dependent on the specific network and user context; a user on a network that is known to perform surveillance would be compromised if they could not access such services, whereas a user on a trusted network might have no privacy motivation to do so.  </p>
<p id="rfc.section.6.1.3.p.2">As a matter of policy, some recursive resolvers use their position in the query path to selectively block access to certain DNS records. This is a form of Rendezvous-Based Blocking as described in Section 4.3 of <a href="#RFC7754" class="xref">[RFC7754]</a>. Such blocklists often include servers known to be used for malware, bots or other security risks. In order to prevent circumvention of their blocking policies, some networks also block access to resolvers with incompatible policies.  </p>
<p id="rfc.section.6.1.3.p.3">It is also noted that attacks on remote resolver services, e.g., DDoS, could force users to switch to other services that do not offer encrypted transports for DNS.  </p>
<h1 id="rfc.section.6.1.4">
<a href="#rfc.section.6.1.4">6.1.4.</a> <a href="#encrypted-transports-and-recursive-resolvers" id="encrypted-transports-and-recursive-resolvers">Encrypted Transports and Recursive Resolvers</a>
</h1>
<h1 id="rfc.section.6.1.4.1">
<a href="#rfc.section.6.1.4.1">6.1.4.1.</a> <a href="#dot-and-doh" id="dot-and-doh">DoT and DoH</a>
</h1>
<p id="rfc.section.6.1.4.1.p.1">Use of encrypted transports does not reduce the data available in the recursive resolver and ironically can actually expose more information about users to operators. As described in <a href="#encrypted-transports" class="xref">Section 5.2</a> use of session based encrypted transports (TCP/TLS) can expose correlation data about users.  </p>
<h1 id="rfc.section.6.1.4.2">
<a href="#rfc.section.6.1.4.2">6.1.4.2.</a> <a href="#doh-specific-considerations" id="doh-specific-considerations">DoH Specific Considerations</a>
</h1>
<p id="rfc.section.6.1.4.2.p.1">DoH inherits the full privacy properties of the HTTPS stack and as a consequence introduces new privacy considerations when compared with DNS over UDP, TCP or TLS <a href="#RFC7858" class="xref">[RFC7858]</a>. Section 8.2 of <a href="#RFC8484" class="xref">[RFC8484]</a> describes the privacy consideration in the server of the DoH protocol.  </p>
<p id="rfc.section.6.1.4.2.p.2">A brief summary of some of the issues includes: </p>
<p></p>

<ul>
<li>HTTPS presents new considerations for correlation, such as explicit HTTP cookies and implicit fingerprinting of the unique set and ordering of HTTP request header fields.</li>
<li>The User-Agent and Accept-Language request header fields often convey specific information about the client version or locale.</li>
<li>Utilizing the full set of HTTP features enables DoH to be more than an HTTP tunnel, but it is at the cost of opening up implementations to the full set of privacy considerations of HTTP.</li>
<li>Implementations are advised to expose the minimal set of data needed to achieve the desired feature set.</li>
</ul>

<p> </p>
<p><a href="#RFC8484" class="xref">[RFC8484]</a> specifically makes selection of HTTPS functionality vs privacy an implementation choice. At the extremes, there may be implementations that attempt to achieve parity with DoT from a privacy perspective at the cost of using no identifiable HTTP headers, there might be others that provide feature rich data flows where the low-level origin of the DNS query is easily identifiable. Some implementations have, in fact, chosen to restrict the use of the 'User-Agent' header so that resolver operators cannot identify the specific application that is originating the DNS queries.  </p>
<p id="rfc.section.6.1.4.2.p.5">Privacy focused users should be aware of the potential for additional client identifiers in DoH compared to DoT and may want to only use DoH client implementations that provide clear guidance on what identifiers they add.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#in-the-authoritative-name-servers" id="in-the-authoritative-name-servers">In the Authoritative Name Servers</a>
</h1>
<p id="rfc.section.6.2.p.1">Unlike what happens for recursive resolvers, observation capabilities of authoritative name servers are limited by caching; they see only the requests for which the answer was not in the cache. For aggregated statistics ("What is the percentage of LOC queries?"), this is sufficient, but it prevents an observer from seeing everything. Similarly the increasing deployment of QNAME minimisation <a href="#ripe-qname-measurements" class="xref">[ripe-qname-measurements]</a> reduces the data visible at the authoritative name server. Still, the authoritative name servers see a part of the traffic, and this subset may be sufficient to violate some privacy expectations.  </p>
<p id="rfc.section.6.2.p.2">Also, the user often has some legal/contractual link with the recursive resolver (he has chosen the IAP, or he has chosen to use a given public resolver), while having no control and perhaps no awareness of the role of the authoritative name servers and their observation abilities.  </p>
<p id="rfc.section.6.2.p.3">As noted before, using a local resolver or a resolver close to the machine decreases the attack surface for an on-the-wire eavesdropper.  But it may decrease privacy against an observer located on an authoritative name server.  This authoritative name server will see the IP address of the end client instead of the address of a big recursive resolver shared by many users.  </p>
<p id="rfc.section.6.2.p.4">This "protection", when using a large resolver with many clients, is no longer present if ECS <a href="#RFC7871" class="xref">[RFC7871]</a> is used because, in this case, the authoritative name server sees the original IP address (or prefix, depending on the setup).  </p>
<p id="rfc.section.6.2.p.5">As of today, all the instances of one root name server, L-root, receive together around 50,000 queries per second.  While most of it is "junk" (errors on the Top-Level Domain (TLD) name), it gives an idea of the amount of big data that pours into name servers.  (And even "junk" can leak information; for instance, if there is a typing error in the TLD, the user will send data to a TLD that is not the usual one.) </p>
<p id="rfc.section.6.2.p.6">Many domains, including TLDs, are partially hosted by third-party servers, sometimes in a different country.  The contracts between the domain manager and these servers may or may not take privacy into account.  Whatever the contract, the third-party hoster may be honest or not but, in any case, it will have to follow its local laws.  For example, requests to a given ccTLD may go to servers managed by organizations outside of the ccTLD's country.  Users may not anticipate that, when doing a security analysis.  </p>
<p id="rfc.section.6.2.p.7">Also, it seems (see the survey described in <a href="#aeris-dns" class="xref">[aeris-dns]</a>) that there is a strong concentration of authoritative name servers among "popular" domains (such as the Alexa Top N list). For instance, among the <a href="https://www.alexa.com/topsites">Alexa Top 100K</a>, one DNS provider hosts today 10% of the domains. The ten most important DNS providers host together one third of the domains. With the control (or the ability to sniff the traffic) of a few name servers, you can gather a lot of information.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#other-risks" id="other-risks">Other risks</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#reidentification-and-other-inferences" id="reidentification-and-other-inferences">Re-identification and Other Inferences</a>
</h1>
<p id="rfc.section.7.1.p.1">An observer has access not only to the data he/she directly collects but also to the results of various inferences about this data. The term 'observer' here is used very generally, it might be one that is passively observing cleartext DNS traffic, one in the network that is actively attacking the user by re-directing DNS resolution, or it might be a local or remote resolver operator.  </p>
<p id="rfc.section.7.1.p.2">For instance, a user can be re-identified via DNS queries.  If the adversary knows a user's identity and can watch their DNS queries for a period, then that same adversary may be able to re-identify the user solely based on their pattern of DNS queries later on regardless of the location from which the user makes those queries.  For example, one study <a href="#herrmann-reidentification" class="xref">[herrmann-reidentification]</a> found that such re- identification is possible so that "73.1% of all day-to-day links were correctly established, i.e., user u was either re-identified unambiguously (1) or the classifier correctly reported that u was not present on day t+1 any more (2)."  While that study related to web browsing behavior, equally characteristic patterns may be produced even in machine-to-machine communications or without a user taking specific actions, e.g., at reboot time if a characteristic set of services are accessed by the device.  </p>
<p id="rfc.section.7.1.p.3">For instance, one could imagine that an intelligence agency identifies people going to a site by putting in a very long DNS name and looking for queries of a specific length.  Such traffic analysis could weaken some privacy solutions.  </p>
<p id="rfc.section.7.1.p.4">The IAB privacy and security program also have a document <a href="#RFC7624" class="xref">[RFC7624]</a> that considers such inference-based attacks in a more general framework.  </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#more-information" id="more-information">More Information</a>
</h1>
<p id="rfc.section.7.2.p.1">Useful background information can also be found in <a href="#tor-leak" class="xref">[tor-leak]</a> (about the risk of privacy leak through DNS) and in a few academic papers: <a href="#yanbin-tsudik" class="xref">[yanbin-tsudik]</a>, <a href="#castillo-garcia" class="xref">[castillo-garcia]</a>, <a href="#fangming-hori-sakurai" class="xref">[fangming-hori-sakurai]</a>, and <a href="#federrath-fuchs-herrmann-piosecny" class="xref">[federrath-fuchs-herrmann-piosecny]</a>.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#actual-attacks" id="actual-attacks">Actual "Attacks"</a>
</h1>
<p id="rfc.section.8.p.1">A very quick examination of DNS traffic may lead to the false conclusion that extracting the needle from the haystack is difficult. "Interesting" primary DNS requests are mixed with useless (for the eavesdropper) secondary and tertiary requests (see the terminology in <a href="#introduction" class="xref">Section 1</a>). But, in this time of "big data" processing, powerful techniques now exist to get from the raw data to what the eavesdropper is actually interested in.  </p>
<p id="rfc.section.8.p.2">Many research papers about malware detection use DNS traffic to detect "abnormal" behavior that can be traced back to the activity of malware on infected machines.  Yes, this research was done for the good, but technically it is a privacy attack and it demonstrates the power of the observation of DNS traffic.  See <a href="#dns-footprint" class="xref">[dns-footprint]</a>, <a href="#dagon-malware" class="xref">[dagon-malware]</a>, and <a href="#darkreading-dns" class="xref">[darkreading-dns]</a>.  </p>
<p id="rfc.section.8.p.3">Passive DNS systems <a href="#passive-dns" class="xref">[passive-dns]</a> allow reconstruction of the data of sometimes an entire zone. Well-known passive DNS systems keep only the DNS responses, and not the source IP address of the client, precisely for privacy reasons.  Other passive DNS systems may not be so careful.  And there is still the potential problems with revealing QNAMEs.  </p>
<p id="rfc.section.8.p.4">The revelations from the Edward Snowden documents, which were leaked from the National Security Agency (NSA), provide evidence of the use of the DNS in mass surveillance operations <a href="#morecowbell" class="xref">[morecowbell]</a>. For example the MORECOWBELL surveillance program, which uses a dedicated covert monitoring infrastructure to actively query DNS servers and perform HTTP requests to obtain meta information about services and to check their availability. Also the <a href="https://theintercept.com/document/2014/03/12/nsa-gchqs-quantumtheory-hacking-tactics/">QUANTUMTHEORY</a> project which includes detecting lookups for certain addresses and injecting bogus replies is another good example showing that the lack of privacy protections in the DNS is actively exploited.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#legalities" id="legalities">Legalities</a>
</h1>
<p id="rfc.section.9.p.1">To our knowledge, there are no specific privacy laws for DNS data, in any country. Interpreting general privacy laws like <a href="#data-protection-directive" class="xref">[data-protection-directive]</a> or <a href="https://www.eugdpr.org/the-regulation.html">GDPR</a> applicable in the European Union in the context of DNS traffic data is not an easy task, and there is no known court precedent. See an interesting analysis in <a href="#sidn-entrada" class="xref">[sidn-entrada]</a>.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.10.p.1">This document is entirely about security, more precisely privacy. It just lays out the problem; it does not try to set requirements (with the choices and compromises they imply), much less define solutions. Possible solutions to the issues described here are discussed in other documents (currently too many to all be mentioned); see, for instance, 'Recommendations for DNS Privacy Operators' <a href="#I-D.ietf-dprive-bcp-op" class="xref">[I-D.ietf-dprive-bcp-op]</a>.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.11.p.1">This document makes no requests of the IANA.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#contributions" id="contributions">Contributions</a>
</h1>
<p id="rfc.section.12.p.1">Sara Dickinson and Stephane Bortzmeyer were the original authors on the document, and their contribution on the initial version is greatly appreciated.  </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.13.p.1">Thanks to Nathalie Boulvard and to the CENTR members for the original work that led to this document. Thanks to Ondrej Sury for the interesting discussions. Thanks to Mohsen Souissi and John Heidemann for proofreading and to Paul Hoffman, Matthijs Mekking, Marcos Sanz, Tim Wicinski, Francis Dupont, Allison Mankin, and Warren Kumari for proofreading, providing technical remarks, and making many readability improvements. Thanks to Dan York, Suzanne Woolf, Tony Finch, Stephen Farrell, Peter Koch, Simon Josefsson, and Frank Denis for good written contributions. Thanks to Vittorio Bertola and Mohamed Boucadair for a detailed review of the -bis. And thanks to the IESG members for the last remarks.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">14.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">14.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1034">[RFC1034]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>", STD 13, RFC 1034, DOI 10.17487/RFC1034, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6973">[RFC6973]</b></td>
<td class="top">
<a>Cooper, A.</a>, <a>Tschofenig, H.</a>, <a>Aboba, B.</a>, <a>Peterson, J.</a>, <a>Morris, J.</a>, <a>Hansen, M.</a> and <a>R. Smith</a>, "<a href="https://tools.ietf.org/html/rfc6973">Privacy Considerations for Internet Protocols</a>", RFC 6973, DOI 10.17487/RFC6973, July 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7258">[RFC7258]</b></td>
<td class="top">
<a>Farrell, S.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc7258">Pervasive Monitoring Is an Attack</a>", BCP 188, RFC 7258, DOI 10.17487/RFC7258, May 2014.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">14.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="aeris-dns">[aeris-dns]</b></td>
<td class="top">
<a>Vinot, N.</a>, "<a href="https://blog.imirhil.fr/vie-privee-et-le-dns-alors.html">Vie privee: et le DNS alors?</a>", (In French), 2015.</td>
</tr>
<tr>
<td class="reference"><b id="cache-snooping-defence">[cache-snooping-defence]</b></td>
<td class="top">
<a>ISC</a>, "<a href="https://kb.isc.org/docs/aa-00482">ISC Knowledge Database: DNS Cache snooping - should I be concerned?</a>", 2018.</td>
</tr>
<tr>
<td class="reference"><b id="castillo-garcia">[castillo-garcia]</b></td>
<td class="top">
<a>Castillo-Perez, S.</a> and <a>J. Garcia-Alfaro</a>, "<a href="http://deic.uab.es/~joaquin/papers/is08.pdf">Anonymous Resolution of DNS Queries</a>", 2008.</td>
</tr>
<tr>
<td class="reference"><b id="centralisation-and-data-sovereignty">[centralisation-and-data-sovereignty]</b></td>
<td class="top">
<a>De Filippi, P.</a> and <a>S. McCarthy</a>, "<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2167372">Cloud Computing: Centralization and Data Sovereignty</a>", October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="dagon-malware">[dagon-malware]</b></td>
<td class="top">
<a>Dagon, D.</a>, "<a href="https://www.dns-oarc.net/files/workshop-2007/Dagon-Resolution-corruption.pdf">Corrupted DNS Resolution Paths: The Rise of a Malicious Resolution Authority</a>", ISC/OARC Workshop, 2007.</td>
</tr>
<tr>
<td class="reference"><b id="darkreading-dns">[darkreading-dns]</b></td>
<td class="top">
<a>Lemos, R.</a>, "<a href="http://www.darkreading.com/analytics/security-monitoring/got-malware-three-signs-revealed-in-dns-traffic/d/d-id/1139680">Got Malware? Three Signs Revealed In DNS Traffic</a>", InformationWeek Dark Reading, May 2013.</td>
</tr>
<tr>
<td class="reference"><b id="data-protection-directive">[data-protection-directive]</b></td>
<td class="top">
<a>European Parliament</a>, "<a href="http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:31995L0046:EN:HTML">Directive 95/46/EC of the European Parliament and of the council on the protection of individuals with regard to the processing of personal data and on the free movement of such data</a>", Official Journal L 281, pp. 0031 - 0050, November 1995.</td>
</tr>
<tr>
<td class="reference"><b id="day-at-root">[day-at-root]</b></td>
<td class="top">
<a>Castro, S.</a>, <a>Wessels, D.</a>, <a>Fomenkov, M.</a> and <a>K. Claffy</a>, "<a href="http://www.sigcomm.org/sites/default/files/ccr/papers/2008/October/1452335-1452341.pdf">A Day at the Root of the Internet</a>", ACM SIGCOMM Computer Communication Review, Vol. 38, Number 5, DOI 10.1145/1452335.1452341, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="denis-edns-client-subnet">[denis-edns-client-subnet]</b></td>
<td class="top">
<a>Denis, F.</a>, "<a href="https://00f.net/2013/08/07/edns-client-subnet/">Security and privacy issues of edns-client-subnet</a>", August 2013.</td>
</tr>
<tr>
<td class="reference"><b id="ditl">[ditl]</b></td>
<td class="top">
<a>CAIDA</a>, "<a href="http://www.caida.org/projects/ditl/">A Day in the Life of the Internet (DITL)</a>", 2002.</td>
</tr>
<tr>
<td class="reference"><b id="dns-footprint">[dns-footprint]</b></td>
<td class="top">
<a>Stoner, E.</a>, "<a href="https://www.dns-oarc.net/files/workshop-201010/OARC-ers-20101012.pdf">DNS Footprint of Malware</a>", OARC Workshop, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="dns-over-encryption">[dns-over-encryption]</b></td>
<td class="top">
<a>Lu, C.</a>, <a>Liu, B.</a>, <a>Li, Z.</a>, <a>Hao, S.</a>, <a>Duan, H.</a>, <a>Zhang, M.</a>, <a>Leng, C.</a>, <a>Liu, Y.</a>, <a>Zhang, Z.</a> and <a>J. Wu</a>, "<a href="http://dl.acm.org/citation.cfm?id=3355369.3355580">An End-to-End, Large-Scale Measurement of DNS-over-Encryption</a>", IMC '19 Amsterdam, Netherlands, DOI 10.1145/3355369.3355580, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="dnsmezzo">[dnsmezzo]</b></td>
<td class="top">
<a>Bortzmeyer, S.</a>, "<a href="http://www.dnsmezzo.net/">DNSmezzo</a>", 2009.</td>
</tr>
<tr>
<td class="reference"><b id="EDDI">[EDDI]</b></td>
<td class="top">
<a>EDDI</a>, "<a href="https://www.encrypted-dns.org">Encrypted DNS Deployment Initiative</a>", 2020.</td>
</tr>
<tr>
<td class="reference"><b id="fangming-hori-sakurai">[fangming-hori-sakurai]</b></td>
<td class="top">
<a>Fangming, Z.</a>, <a>Hori, Y.</a> and <a>K. Sakurai</a>, "<a href="http://dl.acm.org/citation.cfm?id=1262690.1262986">Analysis of Privacy Disclosure in DNS Query</a>", 2007 International Conference on Multimedia and Ubiquitous Engineering (MUE 2007), Seoul, Korea, ISBN: 0-7695-2777-9, pp. 952-957, DOI 10.1109/MUE.2007.84, April 2007.</td>
</tr>
<tr>
<td class="reference"><b id="federrath-fuchs-herrmann-piosecny">[federrath-fuchs-herrmann-piosecny]</b></td>
<td class="top">
<a>Federrath, H.</a>, <a>Fuchs, K.</a>, <a>Herrmann, D.</a> and <a>C. Piosecny</a>, "<a href="https://svs.informatik.uni-hamburg.de/publications/2011/2011-09-14_FFHP_PrivacyPreservingDNS_ESORICS2011.pdf">Privacy-Preserving DNS: Analysis of Broadcast, Range Queries and Mix-based Protection Methods</a>", Computer Security ESORICS 2011, Springer, page(s) 665-683, ISBN 978-3-642-23821-5, 2011.</td>
</tr>
<tr>
<td class="reference"><b id="getdns">[getdns]</b></td>
<td class="top">
<a>getdns</a>, "<a href="https://getdnsapi.net">getdns - A modern asynchronous DNS API</a>", January 2020.</td>
</tr>
<tr>
<td class="reference"><b id="grangeia.snooping">[grangeia.snooping]</b></td>
<td class="top">
<a>Grangeia, L.</a>, "<a href="https://www.semanticscholar.org/paper/Cache-Snooping-or-Snooping-the-Cache-for-Fun-and-1-Grangeia/9b22f606e10b3609eafbdcbfc9090b63be8778c3">DNS Cache Snooping or Snooping the Cache for Fun and Profit</a>", 2005.</td>
</tr>
<tr>
<td class="reference"><b id="herrmann-reidentification">[herrmann-reidentification]</b></td>
<td class="top">
<a>Herrmann, D.</a>, <a>Gerber, C.</a>, <a>Banse, C.</a> and <a>H. Federrath</a>, "<a href="http://epub.uni-regensburg.de/21103/1/Paper_PUL_nordsec_published.pdf">Analyzing Characteristic Host Access Patterns for Re-Identification of Web User Sessions</a>", DOI 10.1007/978-3-642-27937-9_10, 2012.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-dnsop-resolver-information">[I-D.ietf-dnsop-resolver-information]</b></td>
<td class="top">
<a>Sood, P.</a>, <a>Arends, R.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dnsop-resolver-information-01">DNS Resolver Information Self-publication</a>", Internet-Draft draft-ietf-dnsop-resolver-information-01, February 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-dprive-bcp-op">[I-D.ietf-dprive-bcp-op]</b></td>
<td class="top">
<a>Dickinson, S.</a>, <a>Overeinder, B.</a>, <a>Rijswijk-Deij, R.</a> and <a>A. Mankin</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dprive-bcp-op-14">Recommendations for DNS Privacy Service Operators</a>", Internet-Draft draft-ietf-dprive-bcp-op-14, July 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-dprive-dnsoquic">[I-D.ietf-dprive-dnsoquic]</b></td>
<td class="top">
<a>Huitema, C.</a>, <a>Mankin, A.</a> and <a>S. Dickinson</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dprive-dnsoquic-01">Specification of DNS over Dedicated QUIC Connections</a>", Internet-Draft draft-ietf-dprive-dnsoquic-01, October 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-quic-transport">[I-D.ietf-quic-transport]</b></td>
<td class="top">
<a>Iyengar, J.</a> and <a>M. Thomson</a>, "<a href="https://tools.ietf.org/html/draft-ietf-quic-transport-34">QUIC: A UDP-Based Multiplexed and Secure Transport</a>", Internet-Draft draft-ietf-quic-transport-34, January 2021.</td>
</tr>
<tr>
<td class="reference"><b id="morecowbell">[morecowbell]</b></td>
<td class="top">
<a>Grothoff, C.</a>, <a>Wachs, M.</a>, <a>Ermert, M.</a> and <a>J. Appelbaum</a>, "<a href="https://pdfs.semanticscholar.org/2610/2b99bdd6a258a98740af8217ba8da8a1e4fa.pdf">NSA's MORECOWBELL: Knell for DNS</a>", GNUnet e.V., January 2015.</td>
</tr>
<tr>
<td class="reference"><b id="packetq">[packetq]</b></td>
<td class="top">
<a>DNS-OARC</a>, "<a href="https://github.com/DNS-OARC/PacketQ">PacketQ, a simple tool to make SQL-queries against PCAP-files</a>", 2011.</td>
</tr>
<tr>
<td class="reference"><b id="passive-dns">[passive-dns]</b></td>
<td class="top">
<a>Weimer, F.</a>, "<a href="https://www.first.org/conference/2005/papers/florian-weimer-slides-1.pdf">Passive DNS Replication</a>", April 2005.</td>
</tr>
<tr>
<td class="reference"><b id="pitfalls-of-dns-encryption">[pitfalls-of-dns-encryption]</b></td>
<td class="top">
<a>Shulman, H.</a>, "<a href="https://dl.acm.org/citation.cfm?id=2665959">Pretty Bad Privacy:Pitfalls of DNS Encryption</a>"</td>
</tr>
<tr>
<td class="reference"><b id="prism">[prism]</b></td>
<td class="top">
<a>Wikipedia</a>, "<a href="https://en.wikipedia.org/w/index.php?title=PRISM_(surveillance_program)&amp;oldid=673789455">PRISM (surveillance program)</a>", July 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3552">[RFC3552]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>B. Korver</a>, "<a href="https://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>", BCP 72, RFC 3552, DOI 10.17487/RFC3552, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="https://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, DOI 10.17487/RFC4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4470">[RFC4470]</b></td>
<td class="top">
<a>Weiler, S.</a> and <a>J. Ihren</a>, "<a href="https://tools.ietf.org/html/rfc4470">Minimally Covering NSEC Records and DNSSEC On-line Signing</a>", RFC 4470, DOI 10.17487/RFC4470, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5155">[RFC5155]</b></td>
<td class="top">
<a>Laurie, B.</a>, <a>Sisson, G.</a>, <a>Arends, R.</a> and <a>D. Blacka</a>, "<a href="https://tools.ietf.org/html/rfc5155">DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</a>", RFC 5155, DOI 10.17487/RFC5155, March 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5936">[RFC5936]</b></td>
<td class="top">
<a>Lewis, E.</a> and <a>A. Hoenes</a>, "<a href="https://tools.ietf.org/html/rfc5936">DNS Zone Transfer Protocol (AXFR)</a>", RFC 5936, DOI 10.17487/RFC5936, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6269">[RFC6269]</b></td>
<td class="top">
<a>Ford, M.</a>, <a>Boucadair, M.</a>, <a>Durand, A.</a>, <a>Levis, P.</a> and <a>P. Roberts</a>, "<a href="https://tools.ietf.org/html/rfc6269">Issues with IP Address Sharing</a>", RFC 6269, DOI 10.17487/RFC6269, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6891">[RFC6891]</b></td>
<td class="top">
<a>Damas, J.</a>, <a>Graff, M.</a> and <a>P. Vixie</a>, "<a href="https://tools.ietf.org/html/rfc6891">Extension Mechanisms for DNS (EDNS(0))</a>", STD 75, RFC 6891, DOI 10.17487/RFC6891, April 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7413">[RFC7413]</b></td>
<td class="top">
<a>Cheng, Y.</a>, <a>Chu, J.</a>, <a>Radhakrishnan, S.</a> and <a>A. Jain</a>, "<a href="https://tools.ietf.org/html/rfc7413">TCP Fast Open</a>", RFC 7413, DOI 10.17487/RFC7413, December 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7525">[RFC7525]</b></td>
<td class="top">
<a>Sheffer, Y.</a>, <a>Holz, R.</a> and <a>P. Saint-Andre</a>, "<a href="https://tools.ietf.org/html/rfc7525">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7624">[RFC7624]</b></td>
<td class="top">
<a>Barnes, R.</a>, <a>Schneier, B.</a>, <a>Jennings, C.</a>, <a>Hardie, T.</a>, <a>Trammell, B.</a>, <a>Huitema, C.</a> and <a>D. Borkmann</a>, "<a href="https://tools.ietf.org/html/rfc7624">Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement</a>", RFC 7624, DOI 10.17487/RFC7624, August 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7721">[RFC7721]</b></td>
<td class="top">
<a>Cooper, A.</a>, <a>Gont, F.</a> and <a>D. Thaler</a>, "<a href="https://tools.ietf.org/html/rfc7721">Security and Privacy Considerations for IPv6 Address Generation Mechanisms</a>", RFC 7721, DOI 10.17487/RFC7721, March 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7754">[RFC7754]</b></td>
<td class="top">
<a>Barnes, R.</a>, <a>Cooper, A.</a>, <a>Kolkman, O.</a>, <a>Thaler, D.</a> and <a>E. Nordmark</a>, "<a href="https://tools.ietf.org/html/rfc7754">Technical Considerations for Internet Service Blocking and Filtering</a>", RFC 7754, DOI 10.17487/RFC7754, March 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7816">[RFC7816]</b></td>
<td class="top">
<a>Bortzmeyer, S.</a>, "<a href="https://tools.ietf.org/html/rfc7816">DNS Query Name Minimisation to Improve Privacy</a>", RFC 7816, DOI 10.17487/RFC7816, March 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7858">[RFC7858]</b></td>
<td class="top">
<a>Hu, Z.</a>, <a>Zhu, L.</a>, <a>Heidemann, J.</a>, <a>Mankin, A.</a>, <a>Wessels, D.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7858">Specification for DNS over Transport Layer Security (TLS)</a>", RFC 7858, DOI 10.17487/RFC7858, May 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7871">[RFC7871]</b></td>
<td class="top">
<a>Contavalli, C.</a>, <a>van der Gaast, W.</a>, <a>Lawrence, D.</a> and <a>W. Kumari</a>, "<a href="https://tools.ietf.org/html/rfc7871">Client Subnet in DNS Queries</a>", RFC 7871, DOI 10.17487/RFC7871, May 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7873">[RFC7873]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a> and <a>M. Andrews</a>, "<a href="https://tools.ietf.org/html/rfc7873">Domain Name System (DNS) Cookies</a>", RFC 7873, DOI 10.17487/RFC7873, May 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7929">[RFC7929]</b></td>
<td class="top">
<a>Wouters, P.</a>, "<a href="https://tools.ietf.org/html/rfc7929">DNS-Based Authentication of Named Entities (DANE) Bindings for OpenPGP</a>", RFC 7929, DOI 10.17487/RFC7929, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8446">[RFC8446]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc8446">The Transport Layer Security (TLS) Protocol Version 1.3</a>", RFC 8446, DOI 10.17487/RFC8446, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8484">[RFC8484]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>P. McManus</a>, "<a href="https://tools.ietf.org/html/rfc8484">DNS Queries over HTTPS (DoH)</a>", RFC 8484, DOI 10.17487/RFC8484, October 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8499">[RFC8499]</b></td>
<td class="top">
<a>Hoffman, P.</a>, <a>Sullivan, A.</a> and <a>K. Fujiwara</a>, "<a href="https://tools.ietf.org/html/rfc8499">DNS Terminology</a>", BCP 219, RFC 8499, DOI 10.17487/RFC8499, January 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8744">[RFC8744]</b></td>
<td class="top">
<a>Huitema, C.</a>, "<a href="https://tools.ietf.org/html/rfc8744">Issues and Requirements for Server Name Identification (SNI) Encryption in TLS</a>", RFC 8744, DOI 10.17487/RFC8744, July 2020.</td>
</tr>
<tr>
<td class="reference"><b id="ripe-qname-measurements">[ripe-qname-measurements]</b></td>
<td class="top">
<a title="University of Twente">Vries, W.</a>, "<a href="https://labs.ripe.net/Members/wouter_de_vries/make-dns-a-bit-more-private-with-qname-minimisation">Making the DNS More Private with QNAME Minimisation</a>", April 2019.</td>
</tr>
<tr>
<td class="reference"><b id="sidn-entrada">[sidn-entrada]</b></td>
<td class="top">
<a>Hesselman, C.</a>, <a>Jansen, J.</a>, <a>Wullink, M.</a>, <a>Vink, K.</a> and <a>M. Simon</a>, "<a href="https://www.sidnlabs.nl/downloads/yBW6hBoaSZe4m6GJc_0b7w/2211058ab6330c7f3788141ea19d3db7/SIDN_Labs_Privacyraamwerk_Position_Paper_V1.4_ENG.pdf">A privacy framework for 'DNS big data' applications</a>", November 2014.</td>
</tr>
<tr>
<td class="reference"><b id="thomas-ditl-tcp">[thomas-ditl-tcp]</b></td>
<td class="top">
<a>Thomas, M.</a> and <a>D. Wessels</a>, "<a href="https://indico.dns-oarc.net/event/20/session/2/contribution/15/material/slides/1.pdf">An Analysis of TCP Traffic in Root Server DITL Data</a>", DNS-OARC 2014 Fall Workshop, October 2014.</td>
</tr>
<tr>
<td class="reference"><b id="tor-leak">[tor-leak]</b></td>
<td class="top">
<a>Tor</a>, "<a href="https://www.torproject.org/docs/faq.html.en#WarningsAboutSOCKSandDNSInformationLeaks">DNS leaks in Tor</a>", 2013.</td>
</tr>
<tr>
<td class="reference"><b id="yanbin-tsudik">[yanbin-tsudik]</b></td>
<td class="top">
<a>Yanbin, L.</a> and <a>G. Tsudik</a>, "<a href="http://arxiv.org/abs/0910.2472">Towards Plugging Privacy Leaks in the Domain Name System</a>", October 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#updates-since-rfc7626" id="updates-since-rfc7626">Updates since RFC7626</a>
</h1>
<p id="rfc.section.A.p.1">Update many references; Added discussions of encrypted transports including DoT and DoH; Added section on DNS payload; Added section on authentication of servers; Added section on blocking of services.  With the publishing of RFC7816 on QNAME minimisation, text, references, and initial attempts to measure deployment were added to reflect this.  The text and references on the Snowden revelations were updated.  </p>
<p id="rfc.section.A.p.2">The "Risks overview" section was changed to "Scope" to help clarify the risks being considered.  Text was adding on cellular network DNS, blocking and security.  Considerations for recursive resolvers were collected and placed together.  Addded a discussion on resolver selection.  </p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#changelog" id="changelog">Changelog</a>
</h1>
<p id="rfc.section.B.p.1">draft-ietf-dprive-rfc7626-bis-08 </p>
<p></p>

<ul><li>Second batch of Editorial updates from IESG last call</li></ul>

<p> </p>
<p id="rfc.section.B.p.3">draft-ietf-dprive-rfc7626-bis-07 </p>
<p></p>

<ul><li>First batch of Editorial updates from IESG last call</li></ul>

<p> </p>
<p id="rfc.section.B.p.5">draft-ietf-dprive-rfc7626-bis-06 </p>
<p></p>

<ul>
<li>Removed Sara and Stephane as editors, made chairs as Editor.</li>
<li>Replaced the text in 6.1.1.2 with the text from the -04 version.</li>
<li>Clarified text about resolver selection in 6.1.1.</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.7">draft-ietf-dprive-rfc7626-bis-05 </p>
<p></p>

<ul>
<li>Editorial updates from second IESG last call</li>
<li>Section renumbering as suggested by Vittorio Bertola</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.9">draft-ietf-dprive-rfc7626-bis-04 </p>
<p></p>

<ul>
<li>Tsvart review: Add reference to DNS-over-QUIC, fix typo.</li>
<li>Secdir review: Add text in Section 3 on devices using many networks. Update bullet in 3.4.1 on cellular encryption.</li>
<li>Section 3.5.1.1 - re-work the section to try to address multiple comments.</li>
<li>Section 3.5.1.4 - remove this section as now covered by 3.5.1.1.</li>
<li>Section 3.5.1.5.2 - Remove several paragraphs and more directly reference RFC8484 by including bullet points quoting text from Section 8.2 of RFC8484.  Retain the last 2 paragraphs as they are information for users, not implementors.</li>
<li>Section 3.4.2 - some minor updates made based on specific comments.</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.11">draft-ietf-dprive-rfc7626-bis-03 </p>
<p></p>

<ul>
<li>Address 2 minor nits (typo in section 3.4.1 and adding an IANA section)</li>
<li>Minor updates from AD review</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.13">draft-ietf-dprive-rfc7626-bis-02 </p>
<p></p>

<ul>
<li>Numerous editorial corrections thanks to Mohamed Boucadair and <ul>
<li>Minor additions to Scope section</li>
<li>New text on cellular network DNS</li>
</ul>
</li>
<li>Additional text from Vittorio Bertola on blocking and security</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.15">draft-ietf-dprive-rfc7626-bis-01 </p>
<p></p>

<ul>
<li>Re-structure section 3.5 (was 2.5) <ul>
<li>Collect considerations for recursive resolvers together</li>
<li>Re-work several sections here to clarify their context (e.g., &#8216;Rogue servers' becomes &#8216;Active attacks on resolver configuration&#8217;)</li>
<li>Add discussion of resolver selection</li>
</ul>
</li>
<li>Update text and old reference on Snowdon revelations.</li>
<li>Add text on and references to QNAME minimisation RFC and deployment measurements</li>
<li>Correct outdated references</li>
<li>Clarify scope by adding a Scope section (was Risks overview)</li>
<li>Clarify what risks are considered in section 3.4.2</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.17">draft-ietf-dprive-rfc7626-bis-00 </p>
<p></p>

<ul>
<li>Rename after WG adoption</li>
<li>Use DoT acronym throughout</li>
<li>Minor updates to status of deployment and other drafts</li>
</ul>

<p> </p>
<p id="rfc.section.B.p.19">draft-bortzmeyer-dprive-rfc7626-bis-02 </p>
<p></p>

<ul><li>Update various references and fix some nits.</li></ul>

<p> </p>
<p id="rfc.section.B.p.21">draft-bortzmeyer-dprive-rfc7626-bis-01 </p>
<p></p>

<ul><li>Update reference for dickinson-bcp-op to draft-dickinson-dprive-bcp-op</li></ul>

<p> </p>
<p id="rfc.section.B.p.23">draft-borztmeyer-dprive-rfc7626-bis-00: </p>
<p id="rfc.section.B.p.24">Initial commit.  Differences to RFC7626: </p>
<p></p>

<ul>
<li>Update many references</li>
<li>Add discussions of encrypted transports including DoT and DoH</li>
<li>Add section on DNS payload</li>
<li>Add section on authentication of servers</li>
<li>Add section on blocking of services</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tim Wicinski</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Wicinski</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Elkins</span>,  
		<span class="region">WV</span> 
		<span class="code">26241</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tjw.ietf@gmail.com">tjw.ietf@gmail.com</a></span>

  </address>
</div>

</body>
</html>
